---
title: "Untitled"
output: html_document
date: "2024-09-13"
---

```{r}

# Compare small, medium, and large

ds_ecosystems %>%
  filter(!is.na(water_addition_ml)) %>%
  summarySE(measurevar = "water_addition_ml",
            groupvars = "ecosystem_size") %>%
  ggplot(aes(x = factor(ecosystem_size, levels = c("Small", "Medium", "Large")),
             y = water_addition_ml)) +
  geom_point(stat = "summary",
             fun = "mean",
             position = position_dodge(dodging),
             size = treatment_points_size) +
  labs(x = "",
       y = "Evaporation (ml)") +
  theme_bw() +
    theme(panel.grid.major = element_blank(),
          panel.grid.minor = element_blank(),
          legend.position = legend_position) +
  geom_errorbar(aes(ymax = water_addition_ml + ci,
                    ymin = water_addition_ml - ci),
                  width = width_errorbar,
                  position = position_dodge(dodging))

full_model = lmer(water_addition_ml ~
                  ecosystem_type +
                    (1 | time_point),
                  data = ds_ecosystems,
                  REML = FALSE)

null_model = lmer(water_addition_ml ~
                    (1 | time_point),
                  data = ds_ecosystems,
                  REML = FALSE)

compute.model.stats(full_model,
                    null_model,
                    "mixed_model")


# anova(full_model)
# TukeyHSD(aov(full_model))
```