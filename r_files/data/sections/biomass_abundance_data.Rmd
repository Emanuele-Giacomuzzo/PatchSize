---
title: "data_manipulation"
author: "Emanuele Giacomuzzo"
date: "2022-08-04"
output: html_document
editor_options: 
  chunk_output_type: console
---

### Biomass & abundance

#### Local biomass dataset (`ds_biomass_abund`)

This dataset is the master dataset containing all the information about the biomass of the experiment.

```{r biomass-import, message = FALSE, echo = TRUE}
load(here("data", "population", "t0.RData")); t0 = pop_output
load(here("data", "population", "t1.RData")); t1 = pop_output
load(here("data", "population", "t2.RData")); t2 = pop_output
load(here("data", "population", "t3.RData")); t3 = pop_output
load(here("data", "population", "t4.RData")); t4 = pop_output
load(here("data", "population", "t5.RData")); t5 = pop_output
load(here("data", "population", "t6.RData")); t6 = pop_output
load(here("data", "population", "t7.RData")); t7 = pop_output
rm(pop_output)
```

```{r import-species-data}
species_ID_t0 = read.csv(here("data", "population_species_ID", "species_ID_t0.csv")) %>%
  select(file, Ble:Tet)
species_ID_t1 = read.csv(here("data", "population_species_ID", "species_ID_t1.csv")) %>%
  select(file, Ble:Tet)
species_ID_t2 = read.csv(here("data", "population_species_ID", "species_ID_t2.csv")) %>%
  select(file, Ble:Tet)
species_ID_t3 = read.csv(here("data", "population_species_ID", "species_ID_t3.csv")) %>%
  select(file, Ble:Tet)
species_ID_t4 = read.csv(here("data", "population_species_ID", "species_ID_t4.csv")) %>%
  select(file, Ble:Tet)
species_ID_t5 = read.csv(here("data", "population_species_ID", "species_ID_t5.csv")) %>%
  select(file, Ble:Tet)
species_ID_t6 = read.csv(here("data", "population_species_ID", "species_ID_t6.csv")) %>%
  select(file, Ble:Tet)
species_ID_t7 = read.csv(here("data", "population_species_ID", "species_ID_t7.csv")) %>%
  select(file, Ble:Tet)
```

```{r join-datasets}
t0 = merge(t0, species_ID_t0, by = "file")
t1 = merge(t1, species_ID_t1, by = "file")
t2 = merge(t2, species_ID_t2, by = "file")
t3 = merge(t3, species_ID_t3, by = "file")
t4 = merge(t4, species_ID_t4, by = "file")
t5 = merge(t5, species_ID_t5, by = "file")
t6 = merge(t6, species_ID_t6, by = "file")
t7 = merge(t7, species_ID_t7, by = "file")
rm(species_ID_t0, species_ID_t1, species_ID_t2, species_ID_t3, species_ID_t4, species_ID_t5, species_ID_t6, species_ID_t7)
```


```{r biomass-tidy-time-points, message = FALSE, echo = TRUE}
#Column: time
t0$time = NA
t1$time = NA

#Column: replicate_video
t0$replicate_video = 1:12 #In t1 I took 12 videos of a single 
t1$replicate_video = 1 #In t1 I took only 1 video/culture
t2$replicate_video = 1 #In t2 I took only 1 video/culture
t3$replicate_video = 1 #In t3 I took only 1 video/culture
t4$replicate_video = 1 #In t4 I took only 1 video/culture
t5$replicate_video = 1 #In t5 I took only 1 video/culture
t6 = t6 %>%
  rename(replicate_video = replicate)
t7 = t7 %>%
  rename(replicate_video = replicate)
```

```{r biomass-bind-time-points, message = FALSE, echo = TRUE}
#Elongate t0 (so that it can be merged wiht culture_info)
number_of_columns_t0 = ncol(t0)
nr_of_cultures = nrow(culture_info)
nr_of_videos = nrow(t0)

t0 = t0[rep(row.names(t0), nr_of_cultures),] %>%
   arrange(file) %>%
   mutate(culture_ID = rep(1:nr_of_cultures, times = nr_of_videos))

#Merge time points
t0 = merge(culture_info,t0, by="culture_ID")
t1 = merge(culture_info,t1, by = "culture_ID")
t2 = merge(culture_info,t2, by = "culture_ID")
t3 = merge(culture_info,t3, by = "culture_ID")
t4 = merge(culture_info,t4, by = "culture_ID")
t5 = merge(culture_info,t5, by = "culture_ID")
t6 = merge(culture_info,t6, by = "culture_ID")
t7 = merge(culture_info,t7, by = "culture_ID")
ds_biomass_abund = rbind(t0, t1, t2, t3, t4, t5, t6, t7)
rm(t0, t1, t2, t3, t4, t5, t6, t7)
```

```{r biomass-tidy-columns, message = FALSE, echo = TRUE}
#Take off spilled cultures
ds_biomass_abund = ds_biomass_abund %>%
  filter(! culture_ID %in% ecosystems_to_take_off)

#Column: time_point
ds_biomass_abund$time_point[ds_biomass_abund$time_point=="t0"] = 0
ds_biomass_abund$time_point[ds_biomass_abund$time_point=="t1"] = 1
ds_biomass_abund$time_point[ds_biomass_abund$time_point=="t2"] = 2
ds_biomass_abund$time_point[ds_biomass_abund$time_point=="t3"] = 3
ds_biomass_abund$time_point[ds_biomass_abund$time_point=="t4"] = 4
ds_biomass_abund$time_point[ds_biomass_abund$time_point=="t5"] = 5
ds_biomass_abund$time_point[ds_biomass_abund$time_point=="t6"] = 6
ds_biomass_abund$time_point[ds_biomass_abund$time_point=="t7"] = 7
ds_biomass_abund$time_point = as.character(ds_biomass_abund$time_point)

#Column: day
ds_biomass_abund$day = NA
ds_biomass_abund$day[ds_biomass_abund$time_point== 0] = 0
ds_biomass_abund$day[ds_biomass_abund$time_point== 1] = 4
ds_biomass_abund$day[ds_biomass_abund$time_point== 2] = 8
ds_biomass_abund$day[ds_biomass_abund$time_point== 3] = 12
ds_biomass_abund$day[ds_biomass_abund$time_point== 4] = 16
ds_biomass_abund$day[ds_biomass_abund$time_point== 5] = 20
ds_biomass_abund$day[ds_biomass_abund$time_point== 6] = 24
ds_biomass_abund$day[ds_biomass_abund$time_point== 7] = 28

#Column: size_of_connected_patch
ds_biomass_abund$size_of_connected_patch[ds_biomass_abund$eco_metaeco_type == "S"] = "S"
ds_biomass_abund$size_of_connected_patch[ds_biomass_abund$eco_metaeco_type == "S (S_S)"] = "S"
ds_biomass_abund$size_of_connected_patch[ds_biomass_abund$eco_metaeco_type == "S (S_L)"] = "L"
ds_biomass_abund$size_of_connected_patch[ds_biomass_abund$eco_metaeco_type == "M (M_M)"] = "M"
ds_biomass_abund$size_of_connected_patch[ds_biomass_abund$eco_metaeco_type == "L"] = "L"
ds_biomass_abund$size_of_connected_patch[ds_biomass_abund$eco_metaeco_type == "L (L_L)"] = "L"
ds_biomass_abund$size_of_connected_patch[ds_biomass_abund$eco_metaeco_type == "L (S_L)"] = "S"

#Column: bioarea_tot & biomass_tot
ds_biomass_abund = ds_biomass_abund %>%
  mutate(bioarea_tot = indiv_per_volume * patch_size_volume * 1000) %>% #Bioarea per volume is in micromitre, patch_size volume is in ml 
  mutate(indiv_tot = indiv_per_volume * patch_size_volume * 1000)

#Keep this dataset for the evaporation effects 
ds_for_evaporation = ds_biomass_abund

ds_biomass_abund = ds_biomass_abund %>% 
  select(culture_ID, 
         patch_size,
         patch_size_volume,
         disturbance, 
         metaecosystem_type, 
         indiv_per_volume, 
         replicate_video, 
         time_point,
         day,
         metaecosystem, 
         system_nr, 
         eco_metaeco_type,
         size_of_connected_patch,
         bioarea_per_volume,
         bioarea_tot,
         indiv_per_volume,
         indiv_tot,
         Ble,
         Cep,
         Col,
         Eug,
         Eup,
         Lox,
         Pau,
         Pca,
         Spi,
         Spi_te,
         Tet) %>%
  relocate(culture_ID,
           system_nr,
           disturbance,
           time_point,
           day,
           patch_size,
           patch_size_volume,
           metaecosystem,
           metaecosystem_type,
           eco_metaeco_type,
           size_of_connected_patch,
           replicate_video,
           bioarea_per_volume,
           bioarea_tot,
           indiv_per_volume,
           indiv_tot,
           Ble,
           Cep,
           Col,
           Eug,
           Eup,
           Lox,
           Pau,
           Pca,
           Spi,
           Spi_te,
           Tet)
```

```{r alpha-diversity}
ds_biomass_abund = ds_biomass_abund %>%
  mutate(Ble_presence = case_when(Ble > 0 ~ 1,
                                  TRUE ~ 0)) %>%
  mutate(Cep_presence = case_when(Cep > 0 ~ 1,
                                  TRUE ~ 0)) %>%
  mutate(Col_presence = case_when(Col > 0 ~ 1,
                                  TRUE ~ 0)) %>%
  mutate(Eug_presence = case_when(Eup > 0 ~ 1,
                                  TRUE ~ 0)) %>%
  mutate(Eup_presence = case_when(Eug > 0 ~ 1,
                                  TRUE ~ 0)) %>%
  mutate(Lox_presence = case_when(Lox > 0 ~ 1,
                                  TRUE ~ 0)) %>%
  mutate(Pau_presence = case_when(Pau > 0 ~ 1,
                                  TRUE ~ 0)) %>%
  mutate(Pca_presence = case_when(Pca > 0 ~ 1,
                                  TRUE ~ 0)) %>%
  mutate(Spi_presence = case_when(Spi > 0 ~ 1,
                                  TRUE ~ 0)) %>%
  mutate(Spi_te_presence = case_when(Spi_te > 0 ~ 1,
                                  TRUE ~ 0)) %>%
  mutate(Tet_presence = case_when(Tet > 0 ~ 1,
                                  TRUE ~ 0)) %>%
  mutate(species_richness = Ble_presence +
                            Cep_presence +
                            Col_presence +
                            Eug_presence +
                            Eup_presence +
                            Lox_presence +
                            Pau_presence +
                            Pca_presence +
                            Spi_presence +
                            Spi_te_presence +
                            Tet_presence)
```

```{r beta-diversity, eval = FALSE}
ds_biomass_abund_averaged = ds_biomass_abund %>%
  group_by(system_nr,
           time_point) %>%
  mutate(bioarea_per_volume = mean(bioarea_per_volume)) %>%
  ungroup() %>%
  mutate(Ble_presence = case_when(Ble > 0 ~ 1,
                                  TRUE ~ 0)) %>%
  mutate(Cep_presence = case_when(Cep > 0 ~ 1,
                                  TRUE ~ 0)) %>%
  mutate(Col_presence = case_when(Col > 0 ~ 1,
                                  TRUE ~ 0)) %>%
  mutate(Eug_presence = case_when(Eup > 0 ~ 1,
                                  TRUE ~ 0)) %>%
  mutate(Eup_presence = case_when(Eug > 0 ~ 1,
                                  TRUE ~ 0)) %>%
  mutate(Lox_presence = case_when(Lox > 0 ~ 1,
                                  TRUE ~ 0)) %>%
  mutate(Pau_presence = case_when(Pau > 0 ~ 1,
                                  TRUE ~ 0)) %>%
  mutate(Pca_presence = case_when(Pca > 0 ~ 1,
                                  TRUE ~ 0)) %>%
  mutate(Spi_presence = case_when(Spi > 0 ~ 1,
                                  TRUE ~ 0)) %>%
  mutate(Spi_te_presence = case_when(Spi_te > 0 ~ 1,
                                  TRUE ~ 0)) %>%
  mutate(Tet_presence = case_when(Tet > 0 ~ 1,
                                  TRUE ~ 0)) %>%
  mutate(species_richness = Ble_presence +
                            Cep_presence +
                            Col_presence +
                            Eug_presence +
                            Eup_presence +
                            Lox_presence +
                            Pau_presence +
                            Pca_presence +
                            Spi_presence +
                            Spi_te_presence +
                            Tet_presence)

beta_diversity = ds_biomass %>%
  group_by(system_nr, time_point) %>%
  summarise()
  filter(system_nr == system_nr_input, 
         time_point == time_point_input) %>%
  select(system_nr_input, time_point_input)
```


```{r}
datatable(ds_biomass_abund,
          rownames = FALSE,
          options = list(scrollX = TRUE),
          filter = list(position = 'top', 
                        clear = FALSE))
```

#### Local biomass [effect size]{.underline} data-set (`ds_effect_size_bioarea_density)`

```{r create-ds_effect_size_bioarea_density}
eco_metaeco_types = unique(ds_biomass_abund$eco_metaeco_type)
small_patches = c("S", "S (S_S)", "S (S_L)")
medium_patches = c("M", "M (M_M)")
large_patches = c("L", "L (L_L)", "L (S_L)")

averaged_bioarea_density = ds_biomass_abund %>%
        group_by(culture_ID, time_point) %>%
        mutate(bioarea_per_volume_across_videos = mean(bioarea_per_volume)) %>%
        ungroup() %>%
        group_by(disturbance, eco_metaeco_type, time_point) %>%
        mutate(mean_bioarea_density = mean(bioarea_per_volume_across_videos),
                  sd_bioarea_density = sd(bioarea_per_volume_across_videos),
                  sam_size_bioarea_density = n()) %>%
        ungroup() %>%
        mutate(mean_bioarea_density_isolated = NA,
               sd_bioarea_density_isolated = NA,
               sam_size_bioarea_density_isolated = NA)

for (disturbance_input in c("low", "high")){
  for (eco_metaeco_input in eco_metaeco_types){
    for (time_point_input in 0:7){
    
      if (eco_metaeco_input %in% small_patches){isolated_patch_type = "S"}
      if (eco_metaeco_input %in% medium_patches){isolated_patch_type = "M"}
      if (eco_metaeco_input %in% large_patches){isolated_patch_type = "L"}
      
      control_row = averaged_bioarea_density %>%
        filter(eco_metaeco_type == isolated_patch_type,
               disturbance == disturbance_input,
               time_point == time_point_input)
      
      averaged_bioarea_density$mean_bioarea_density_isolated[
        averaged_bioarea_density$eco_metaeco_type == eco_metaeco_input &
        averaged_bioarea_density$disturbance == disturbance_input &
        averaged_bioarea_density$time_point == time_point_input] =
      control_row$mean_bioarea_density
      
      averaged_bioarea_density$sd_bioarea_density_isolated[
        averaged_bioarea_density$eco_metaeco_type == eco_metaeco_input &
        averaged_bioarea_density$disturbance == disturbance_input &
        averaged_bioarea_density$time_point == time_point_input] = 
      control_row$sd_bioarea_density
      
      averaged_bioarea_density$sam_size_bioarea_density_isolated[
        averaged_bioarea_density$eco_metaeco_type == eco_metaeco_input & 
        averaged_bioarea_density$disturbance == disturbance_input &
        averaged_bioarea_density$time_point == time_point_input] = 
      control_row$sam_size_bioarea_density
      
      }}}

ds_effect_size_bioarea_density = averaged_bioarea_density %>%
  mutate(bioarea_density_hedges_d = calculate.hedges_d(mean_bioarea_density,
                                       sd_bioarea_density,
                                       sam_size_bioarea_density,
                                       mean_bioarea_density_isolated,
                                       sd_bioarea_density_isolated,
                                       sam_size_bioarea_density_isolated)) %>%
  mutate(bioarea_density_lnRR = ln(mean_bioarea_density / mean_bioarea_density_isolated))
```

```{r}
datatable(ds_effect_size_bioarea_density,
          rownames = FALSE,
          options = list(scrollX = TRUE),
          filter = list(position = 'top', 
                        clear = FALSE))
```

#### Regional biomass data set (`ds_regional_biomass`)

This is the dataset of the regional biomass of different meta-ecosystems. It contains also the regional biomass of the combination of a small isolated and a large isolated patch (`S_L_from_isolated`).

```{r regional-biomass}
ds_regional_biomass = ds_biomass_abund %>%
  filter(metaecosystem == "yes",
         ! system_nr %in% metaecosystems_to_take_off) %>%
  group_by(culture_ID, time_point) %>%
  mutate(bioarea_per_volume_video_averaged = mean(bioarea_per_volume)) %>%
  ungroup() %>%
  mutate(total_patch_bioarea = bioarea_per_volume_video_averaged * patch_size_volume) %>%
  group_by(system_nr, time_point) %>%
  mutate(total_regional_bioarea = sum(total_patch_bioarea)) %>%
  ungroup()
```

```{r create-SL_SL_from_isolated, message=FALSE, results='hide', eval = recompute_analyses}
isolated_S_and_L = ds_biomass_abund %>%
  filter(eco_metaeco_type == "S" | eco_metaeco_type == "L") %>%
  group_by(system_nr, time_point) %>%
  mutate(bioarea_per_volume_across_videos = mean(bioarea_per_volume)) %>%
  ungroup()

isolated_S_low = isolated_S_and_L %>%
  filter(eco_metaeco_type == "S",
         disturbance == "low")
isolated_L_low = isolated_S_and_L %>%
  filter(eco_metaeco_type == "L",
         disturbance == "low")
isolated_S_high = isolated_S_and_L %>%
  filter(eco_metaeco_type == "S",
         disturbance == "high")
isolated_L_high = isolated_S_and_L %>%
  filter(eco_metaeco_type == "L",
         disturbance == "high")

S_low_system_nrs = unique(isolated_S_low$system_nr)
S_high_system_nrs = unique(isolated_S_high$system_nr)
L_low_system_nrs = unique(isolated_L_low$system_nr)
L_high_system_nrs = unique(isolated_L_high$system_nr)

low_system_nrs_combination = expand.grid(S_low_system_nrs, L_low_system_nrs) %>%
  mutate(disturbance = "low")
high_system_nrs_combination = expand.grid(S_high_system_nrs, L_high_system_nrs) %>%
  mutate(disturbance = "high")
system_nr_combinations = rbind(low_system_nrs_combination, high_system_nrs_combination) %>%
  rename(S_system_nr = Var1) %>%
  rename(L_system_nr = Var2)

number_of_combinations = nrow(system_nr_combinations)
SL_from_isolated_all_combinations = NULL
for (pair in 1:number_of_combinations){
  
  SL_from_isolated_one_combination = 
    ds_biomass_abund %>%
    filter(system_nr %in% system_nr_combinations[pair,]) %>%
    group_by(disturbance, day, time_point, system_nr) %>%
    summarise(regional_bioarea_across_videos = mean(bioarea_per_volume)) %>%
    group_by(disturbance, day, time_point) %>%
    summarise(total_regional_bioarea = sum(regional_bioarea_across_videos)) %>%
    mutate(system_nr = 1000 + pair) %>%
    mutate(metaecosystem_type = "S_L_from_isolated")
  
  SL_from_isolated_all_combinations[[pair]] = SL_from_isolated_one_combination}


SL_from_isolated_all_combinations_together = NULL
for (combination in 1:number_of_combinations){
 
  SL_from_isolated_all_combinations_together = 
    rbind(SL_from_isolated_all_combinations_together,
          SL_from_isolated_all_combinations[[pair]])}

ds_regional_biomass = rbind(ds_regional_biomass, SL_from_isolated_all_combinations_together)

saveRDS(ds_regional_biomass, file = here("results", "ds_regional_biomass.RData"))
```

```{r}
ds_regional_biomass = readRDS(here("results", "ds_regional_biomass.RData"))
```

```{r}
datatable(ds_regional_biomass,
          rownames = FALSE,
          options = list(scrollX = TRUE),
          filter = list(position = 'top', 
                        clear = FALSE))
```

#### Community density effect size data-set (`ds_lnRR_community_density)`

```{r create-ds_effect_size_community_density}
eco_metaeco_types = unique(ds_biomass_abund$eco_metaeco_type)
small_patches = c("S", "S (S_S)", "S (S_L)")
medium_patches = c("M", "M (M_M)")
large_patches = c("L", "L (L_L)", "L (S_L)")

averaged_community_density = ds_biomass_abund %>%
        group_by(disturbance, eco_metaeco_type, time_point, culture_ID, patch_size, day) %>%
        summarise(indiv_per_volume_across_videos = mean(indiv_per_volume)) %>%
        group_by(disturbance, eco_metaeco_type, time_point, patch_size, day) %>%
        summarise(mean_community_density = mean(indiv_per_volume_across_videos),
                  sd_community_density = sd(indiv_per_volume_across_videos),
                  sam_size_community_density = n())

for (disturbance_input in c("low", "high")){
  for (eco_metaeco_input in eco_metaeco_types){
    for (time_point_input in 0:7){
    
      if (eco_metaeco_input %in% small_patches){isolated_patch_type = "S"}
      if (eco_metaeco_input %in% medium_patches){isolated_patch_type = "M"}
      if (eco_metaeco_input %in% large_patches){isolated_patch_type = "L"}
      
      control_row = averaged_community_density %>%
        filter(eco_metaeco_type == isolated_patch_type,
               disturbance == disturbance_input,
               time_point == time_point_input)
      
      averaged_community_density$mean_community_density_isolated[
        averaged_community_density$eco_metaeco_type == eco_metaeco_input &
        averaged_community_density$disturbance == disturbance_input &
        averaged_community_density$time_point == time_point_input] = 
      control_row$mean_community_density
      
      averaged_community_density$sd_community_density_isolated[
        averaged_community_density$eco_metaeco_type == eco_metaeco_input & 
        averaged_community_density$disturbance == disturbance_input &
        averaged_community_density$time_point == time_point_input] = 
      control_row$sd_community_density
      
      averaged_community_density$sam_size_community_density_isolated[
        averaged_community_density$eco_metaeco_type == eco_metaeco_input & 
        averaged_community_density$disturbance == disturbance_input &
        averaged_community_density$time_point == time_point_input] = 
      control_row$sam_size_community_density
      
      }}}

ds_effect_size_community_density = averaged_community_density %>%
  mutate(community_density_hedges_d = calculate.hedges_d(mean_community_density,
                                       sd_community_density,
                                       sam_size_community_density,
                                       mean_community_density_isolated,
                                       sd_community_density_isolated,
                                       sam_size_community_density_isolated)) %>%
  mutate(community_density_lnRR = ln(mean_community_density/mean_community_density_isolated))
```

```{r}
datatable(ds_effect_size_community_density,
          rownames = FALSE,
          options = list(scrollX = TRUE),
          filter = list(position = 'top', 
                        clear = FALSE))
```

#### Species ID 

Let's now import the species ID data. I have no clue if it represents biomass or abundances.

```{r import-species-id-data-and-bind}
t0_file_name = here("data", "population_species_ID", "species_ID_t0.csv")
t0 = read.csv(t0_file_name, header = TRUE)  %>%
  mutate(culture_ID = NA, time = NA, replicate = 1:12)

t1_file_name = here("data", "population_species_ID", "species_ID_t1.csv")
t1 = read.csv(t1_file_name, header = TRUE) %>%
  mutate(culture_ID = NA, time = NA, replicate = 1)

t2_file_name = here("data", "population_species_ID", "species_ID_t2.csv")
t2 = read.csv(t2_file_name, header = TRUE) %>%
  mutate(replicate = 1)

t3_file_name = here("data", "population_species_ID", "species_ID_t3.csv")
t3 = read.csv(t3_file_name, header = TRUE) %>%
  mutate(replicate = 1)

t4_file_name = here("data", "population_species_ID", "species_ID_t4.csv")
t4 = read.csv(t4_file_name, header = TRUE) %>%
  mutate(replicate = 1)

t5_file_name = here("data", "population_species_ID", "species_ID_t5.csv")
t5 = read.csv(t5_file_name, header = TRUE) %>%
  mutate(replicate = 1)

t6_file_name = here("data", "population_species_ID", "species_ID_t6.csv")
t6 = read.csv(t6_file_name, header = TRUE)

t7_file_name = here("data", "population_species_ID", "species_ID_t7.csv")
t7 = read.csv(t7_file_name, header = TRUE)

ds_ID = rbind(t0, t1, t2, t3, t4, t5, t6, t7) %>%
  pivot_longer(Ble:Tet, 
               names_to = "species", 
               values_to = "abundance")
```

```{r plot-species-ID}
ds_ID %>%
  filter(time_point == "t1") %>%
  ggplot(aes(x = species,
             y = abundance)) +
  geom_boxplot()
```

[In what dataset should I incorporate species ID data? And how?]{.underline}

[How do I get the species ID of the single particles? (Write to Lynn)]{.underline}

[Look at how to identify Ble by itself.]{.underline}

[Look at whether everything is fine in the videos.]{.underline}

#### 75% body size percentile abundances

[Discover what it tells you.]{.underline}

[Create dataset.]{.underline}

#### 95% body size percentile abundances

[Discover what it tells you.]{.underline}

[Create dataset.]{.underline}
