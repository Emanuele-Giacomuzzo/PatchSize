---
title: "gamma_diversity"
author: "Emanuele Giacomuzzo"
date: "2022-10-18"
output: html_document
editor_options: 
  chunk_output_type: console
---

#### Differently sized patches

```{r}

for (disturbance_input in c("low", "high")) {
  print(
    ds_regional_biomass %>%
      filter(disturbance == disturbance_input) %>%
      filter (metaecosystem_type == "S_L" |
                metaecosystem_type == "M_M") %>%
      ggplot (
        aes(
          x = day,
          y = gamma_diversity,
          group = interaction(day, metaecosystem_type),
          fill = metaecosystem_type
        )
      ) +
      geom_boxplot() +
      labs(
        title = paste("Disturbance =", disturbance_input),
        x = "Day",
        y = "Gamma diversity (nr of species)",
        color = '',
        fill = ''
      ) +
      scale_fill_manual(
        values = c(colour_MM, colour_SL),
        labels = c("Medium-Medium",
                   "Small-Large")) +
      theme_bw() +
      theme(
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        legend.position = c(.3, .3),
        legend.justification = c("right", "top"),
        legend.box.just = "right",
        legend.margin = margin(6, 6, 6, 6)
      )  +
      geom_vline(
        xintercept = first_perturbation_day + 0.7,
        linetype = "dotdash",
        color = "grey",
        size = 0.7
      ) +
      labs(caption = "Vertical grey line: first perturbation")
  )
}

```

#### Equally sized patches

```{r}
for (disturbance_input in c("low", "high")) {
  print(
    ds_regional_biomass %>%
      filter(disturbance == disturbance_input) %>%
      filter(!metaecosystem_type == "S_L") %>%
      filter(!metaecosystem_type == "S_L_from_isolated") %>%
      ggplot(
        aes(
          x = day,
          y = gamma_diversity,
          group = interaction(day, metaecosystem_type),
          fill = metaecosystem_type
        )
      ) +
      geom_boxplot() +
      labs(
        title = "Disturbance = low",
        x = "Day",
        y = "Gamma diversity (nr of species)",
        fill = ""
      ) +
      theme_bw() +
      theme(
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        legend.position = c(.3, .3),
        legend.justification = c("right", "top"),
        legend.box.just = "right",
        legend.margin = margin(6, 6, 6, 6)
      ) +
      scale_fill_manual(
        values = c(colour_large, colour_medium, colour_small),
        labels = c(
        "Large-Large",
        "Medium-Medium",
        "Small-Small"
      )) +
      geom_vline(
        xintercept = first_perturbation_day + 0.7,
        linetype = "dotdash",
        color = "grey",
        size = 0.7
      ) +
      labs(caption = "Vertical grey line: first perturbation")
  )
}
```