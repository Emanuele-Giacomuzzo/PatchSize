---
title: "Body Size Classes Abundance Small Patches"
output: html_document
date: "2022-11-27"
editor_options: 
  chunk_output_type: console
---

```{r}
for(size_class_input in 1:nr_of_size_classes) {
  for (disturbance_input in c("low", "high")) {
    print(
      ds_classes_averaged %>%
        filter(
          eco_metaeco_type %in% c("S (S_S)", ("S (S_L)")),!time_point == 0,
          size_class_n == size_class_input,
          disturbance == disturbance_input
        ) %>%
        ggplot(
          aes(x = day,
              y = abundance_hedges_d,
              colour = eco_metaeco_type)
        ) +
        geom_point(position = position_dodge(0.5)) +
        geom_line(position = position_dodge(0.5)) +
        geom_errorbar(
          aes(ymin = abundance_hedges_d_lower,
              ymax = abundance_hedges_d_upper),
          width = .2,
          position = position_dodge(0.5)
        ) +
        labs(
          title = paste("Disturbance =", disturbance_input),
          x = "Day",
          y = "Bioarea Density Effect Size (Hedge's d)",
          color = ""
        ) +
        scale_color_discrete(
          labels = c("Small connected to large",
                     "Small connnected to small")
        ) +
        scale_x_continuous(breaks = unique(ds_patches_averaged$day)) +
        theme_bw() +
        theme(
          panel.grid.major = element_blank(),
          panel.grid.minor = element_blank(),
          legend.position = "bottom"
        ) +
        geom_vline(
          xintercept = perturbation_days[1] + 0.7,
          linetype = "dotdash",
          color = "grey",
          size = 0.7
        ) +
        geom_vline(
          xintercept = perturbation_days[2] + 0.7,
          linetype = "dotdash",
          color = "grey",
          size = 0.7
        ) +
        geom_vline(
          xintercept = perturbation_days[3] + 0.7,
          linetype = "dotdash",
          color = "grey",
          size = 0.7
        ) +
        geom_vline(
          xintercept = perturbation_days[4] + 0.7,
          linetype = "dotdash",
          color = "grey",
          size = 0.7
        ) +
        geom_vline(
          xintercept = perturbation_days[5] + 0.7,
          linetype = "dotdash",
          color = "grey",
          size = 0.7
        ) +
        geom_vline(
          xintercept = perturbation_days[6] + 0.7,
          linetype = "dotdash",
          color = "grey",
          size = 0.7
        ) +
        geom_hline(
          yintercept = 0,
          linetype = "dotted",
          color = "black",
          size = 0.7
        )
    )
  }
}
```

