---
title: "All MM and SL"
output: html_document
date: "2022-12-13"
editor_options: 
  chunk_output_type: console
---

```{r}
response_variable = "total_metaecosystem_bioarea"
```

```{r}
plot.metaecos.boxplots(metaecosystem_type_input,
                       response_variable)

p_MM_SL_metaecos_biomass = plot.metaecos.points(metaecosystem_type_input,
                                                response_variable)
p_MM_SL_metaecos_biomass
```

**Analysis**

-   Filter the data.

```{r}
filtered_data = ds_metaecosystems %>%
                         filter(time_point >= first_time_point_model,
                                time_point <= last_time_point_model,
                                disturbance == disturbance_input,
                                metaecosystem_type %in% metaecosystem_type_input)
```

-   I'm not sure how to write the model so that it compares the four systems. So I write 4 models for now.

**Small-Large meta-ecosystems vs Small-Large isolated**

```{r}

metaecosystem_type_input_model = c("Small-Large meta-patch",
                             "Small-Large isolated")

plot.metaecos.points(metaecosystem_type_input_model,
                     response_variable)

filtered_data = ds_metaecosystems %>%
                         filter(time_point >= first_time_point_model,
                                time_point <= last_time_point_model,
                                metaecosystem_type %in% metaecosystem_type_input_model)

full_model = lmer(
  total_metaecosystem_bioarea ~
    day +
    connection +
    connection : day + 
    (day | system_nr),
  data = filtered_data,
  REML = FALSE,
  control = lmerControl(optimizer = "Nelder_Mead")
)

summary(full_model)
plot(full_model)
qqnorm(resid(full_model))

null_model = lmer(
  total_metaecosystem_bioarea ~
    day +
    (day | system_nr),
  data = filtered_data,
  REML = FALSE,
  control = lmerControl(optimizer = "Nelder_Mead")
)

summary(null_model)
plot(null_model)
qqnorm(resid(null_model))
model_stats = compute.model.stats(full_model,
                    null_model,
                    "mixed_model")

model_stats
```

**Medium-Medium meta-patch vs MM from isolated**

```{r}
metaecosystem_type_input_model = c("Medium-Medium meta-patch",
                             "Medium-Medium isolated")

plot.metaecos.points(metaecosystem_type_input_model,
                     response_variable)

filtered_data = ds_metaecosystems %>%
                         filter(time_point >= first_time_point_model,
                                time_point <= last_time_point_model,
                                metaecosystem_type %in% metaecosystem_type_input_model)

full_model = lmer(
  total_metaecosystem_bioarea ~
    day +
    connection +
    connection : day + 
    (day | system_nr),
  data = filtered_data,
  REML = FALSE,
  control = lmerControl(optimizer = "Nelder_Mead")
)

summary(full_model)
plot(full_model)
qqnorm(resid(full_model))

null_model = lmer(
  total_metaecosystem_bioarea ~
    day +
    (day | system_nr),
  data = filtered_data,
  REML = FALSE,
  control = lmerControl(optimizer = "Nelder_Mead")
)

summary(null_model)
plot(null_model)
qqnorm(resid(null_model))
model_stats = compute.model.stats(full_model,
                    null_model,
                    "mixed_model")

model_stats
```

**Small-Large meta-patch vs Medium-Medium meta-patch**

```{r}
metaecosystem_type_input_model = c("Small-Large meta-patch",
                             "Medium-Medium meta-patch")

plot.metaecos.points(metaecosystem_type_input_model,
                     response_variable)

filtered_data = ds_metaecosystems %>%
                         filter(time_point >= first_time_point_model,
                                time_point <= last_time_point_model,
                                metaecosystem_type %in% metaecosystem_type_input_model)

full_model = lmer(
  total_metaecosystem_bioarea ~
    day +
    patch_size_symmetry +
    patch_size_symmetry : day + 
    (day | system_nr),
  data = filtered_data,
  REML = FALSE,
  control = lmerControl(optimizer = "Nelder_Mead")
)

summary(full_model)
plot(full_model)
qqnorm(resid(full_model))

null_model = lmer(
  total_metaecosystem_bioarea ~
    day +
    (day | system_nr),
  data = filtered_data,
  REML = FALSE,
  control = lmerControl(optimizer = "Nelder_Mead")
)

summary(null_model)
plot(null_model)
qqnorm(resid(null_model))
model_stats = compute.model.stats(full_model,
                    null_model,
                    "mixed_model")

model_stats
```

**SL from isolated vs MM from isolated**

```{r}
metaecosystem_type_input_model = c("Small-Large isolated",
                             "Medium-Medium isolated")

plot.metaecos.points(metaecosystem_type_input_model,
                     response_variable)

filtered_data = ds_metaecosystems %>%
                         filter(time_point >= first_time_point_model,
                                time_point <= last_time_point_model,
                                metaecosystem_type %in% metaecosystem_type_input_model)

full_model = lmer(
  total_metaecosystem_bioarea ~
    day +
    patch_size_symmetry +
    patch_size_symmetry : day + 
    (day | system_nr),
  data = filtered_data,
  REML = FALSE,
  control = lmerControl(optimizer = "Nelder_Mead")
)

summary(full_model)
plot(full_model)
qqnorm(resid(full_model))

null_model = lmer(
  total_metaecosystem_bioarea ~
    day +
    (day | system_nr),
  data = filtered_data,
  REML = FALSE,
  control = lmerControl(optimizer = "Nelder_Mead")
)


summary(null_model)
plot(null_model)
qqnorm(resid(null_model))
model_stats = compute.model.stats(full_model,
                    null_model,
                    "mixed_model")

model_stats
```
