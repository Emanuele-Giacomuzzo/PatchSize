---
title: "MM_SL_single_points"
author: "Emanuele Giacomuzzo"
date: "2022-08-05"
output: html_document
editor_options: 
  chunk_output_type: console
---

Let's now look at the full model and see if we should keep the interaction between meta-ecosystem type and disturbance. We are not using mixed effects because a certain system nr can't be at different perturbations or at different meta-ecosystem types.

$$
Regional \: bioarea = M + D + MD
$$

**Time point = 2**

```{r}
chosen_time_point = 2
```

```{r}
full = lm(total_regional_bioarea ~
            metaecosystem_type +
            disturbance +
            metaecosystem_type * disturbance,
          data = ds_regional_biomass %>%
                            filter(time_point == chosen_time_point) %>%
                            filter(metaecosystem_type == "M_M" | metaecosystem_type == "S_L"))
```

*Should we keep M \* D?*

```{r}
no_MD = lm(total_regional_bioarea ~
            metaecosystem_type +
            disturbance,
          data = ds_regional_biomass %>%
                            filter(time_point == chosen_time_point) %>%
                            filter(metaecosystem_type == "M_M" | metaecosystem_type == "S_L"))

AIC(full,no_MD)
```

No.

```{r}
best_model = no_MD

R2_full = glance(best_model)$r.squared

no_M = lm(total_regional_bioarea ~
            disturbance,
          data = ds_regional_biomass %>%
                            filter(time_point == chosen_time_point) %>%
                            filter(metaecosystem_type == "M_M" | metaecosystem_type == "S_L"))

R2_no_M = glance(no_M)$r.squared
R2_M = R2_full - R2_no_M

R2_full = round(R2_full, digits = 2)
R2_M = round(R2_M, digits = 2)
```

The adjusted R squared of the model is `r R2_full` and the adjusted R squared of patch type is `r R2_M`.

**Time point = 3**

```{r}
chosen_time_point = 3
```

```{r}
full = lm(total_regional_bioarea ~
            metaecosystem_type +
            disturbance +
            metaecosystem_type * disturbance,
          data = ds_regional_biomass %>%
                            filter(time_point == chosen_time_point) %>%
                            filter(metaecosystem_type == "M_M" | metaecosystem_type == "S_L"))
```

*Should we keep M \* D?*

```{r}
no_MD = lm(total_regional_bioarea ~
            metaecosystem_type +
            disturbance,
          data = ds_regional_biomass %>%
                            filter(time_point == chosen_time_point) %>%
                            filter(metaecosystem_type == "M_M" | metaecosystem_type == "S_L"))

AIC(full,no_MD)
```

Yes.

```{r}
best_model = full

R2_full = glance(best_model)$r.squared

no_M = lm(total_regional_bioarea ~
            disturbance,
          data = ds_regional_biomass %>%
                            filter(time_point == chosen_time_point) %>%
                            filter(metaecosystem_type == "M_M" | metaecosystem_type == "S_L"))

R2_no_M = glance(no_M)$r.squared
R2_M = R2_full - R2_no_M

R2_full = round(R2_full, digits = 2)
R2_M = round(R2_M, digits = 2)
```

The adjusted R squared of the model is `r R2_full` and the adjusted R squared of patch type is `r R2_M` (which includes also the interaction with disturbance).

**Time point = 4**

```{r}
chosen_time_point = 4
```

```{r}
full = lm(total_regional_bioarea ~
            metaecosystem_type +
            disturbance +
            metaecosystem_type * disturbance,
          data = ds_regional_biomass %>%
                            filter(time_point == chosen_time_point) %>%
                            filter(metaecosystem_type == "M_M" | metaecosystem_type == "S_L"))
```

*Should we keep M \* D?*

```{r}
no_MD = lm(total_regional_bioarea ~
            metaecosystem_type +
            disturbance,
          data = ds_regional_biomass %>%
                            filter(time_point == chosen_time_point) %>%
                            filter(metaecosystem_type == "M_M" | metaecosystem_type == "S_L"))

AIC(full,no_MD)
```

No.

```{r}
best_model = no_MD

R2_full = glance(best_model)$r.squared

no_M = lm(total_regional_bioarea ~
            disturbance,
          data = ds_regional_biomass %>%
                            filter(time_point == chosen_time_point) %>%
                            filter(metaecosystem_type == "M_M" | metaecosystem_type == "S_L"))

R2_no_M = glance(no_M)$r.squared
R2_M = R2_full - R2_no_M

R2_full = round(R2_full, digits = 2)
R2_M = round(R2_M, digits = 2)
```

The adjusted R squared of the model is `r R2_full` and the adjusted R squared of patch type is `r R2_M`.

**Time point = 5**

```{r}
chosen_time_point = 5
```

```{r}
full = lm(total_regional_bioarea ~
            metaecosystem_type +
            disturbance +
            metaecosystem_type * disturbance,
          data = ds_regional_biomass %>%
                            filter(time_point == chosen_time_point) %>%
                            filter(metaecosystem_type == "M_M" | metaecosystem_type == "S_L"))
```

*Should we keep M \* D?*

```{r}
no_MD = lm(total_regional_bioarea ~
            metaecosystem_type +
            disturbance,
          data = ds_regional_biomass %>%
                            filter(time_point == chosen_time_point) %>%
                            filter(metaecosystem_type == "M_M" | metaecosystem_type == "S_L"))

AIC(full,no_MD)
```

No.

```{r}
best_model = no_MD

R2_full = glance(best_model)$r.squared

no_M = lm(total_regional_bioarea ~
            disturbance,
          data = ds_regional_biomass %>%
                            filter(time_point == chosen_time_point) %>%
                            filter(metaecosystem_type == "M_M" | metaecosystem_type == "S_L"))

R2_no_M = glance(no_M)$r.squared
R2_M = R2_full - R2_no_M

R2_full = round(R2_full, digits = 2)
R2_M = round(R2_M, digits = 2)
```

The adjusted R squared of the model is `r R2_full` and the adjusted R squared of patch type is `r R2_M`.

**Time point = 6**

```{r}
chosen_time_point = 6
```

```{r}
full = lm(total_regional_bioarea ~
            metaecosystem_type +
            disturbance +
            metaecosystem_type * disturbance,
          data = ds_regional_biomass %>%
                            filter(time_point == chosen_time_point) %>%
                            filter(metaecosystem_type == "M_M" | metaecosystem_type == "S_L"))
```

*Should we keep M \* D?*

```{r}
no_MD = lm(total_regional_bioarea ~
            metaecosystem_type +
            disturbance,
          data = ds_regional_biomass %>%
                            filter(time_point == chosen_time_point) %>%
                            filter(metaecosystem_type == "M_M" | metaecosystem_type == "S_L"))

AIC(full,no_MD)
```

No.

```{r}
best_model = no_MD

R2_full = glance(best_model)$r.squared

no_M = lm(total_regional_bioarea ~
            disturbance,
          data = ds_regional_biomass %>%
                            filter(time_point == chosen_time_point) %>%
                            filter(metaecosystem_type == "M_M" | metaecosystem_type == "S_L"))

R2_no_M = glance(no_M)$r.squared
R2_M = R2_full - R2_no_M

R2_full = round(R2_full, digits = 2)
R2_M = round(R2_M, digits = 2)
```

The adjusted R squared of the model is `r R2_full` and the adjusted R squared of patch type is `r R2_M`.

**Time point = 7**

```{r}
chosen_time_point = 7
```

```{r}
full = lm(total_regional_bioarea ~
            metaecosystem_type +
            disturbance +
            metaecosystem_type * disturbance,
          data = ds_regional_biomass %>%
                            filter(time_point == chosen_time_point) %>%
                            filter(metaecosystem_type == "M_M" | metaecosystem_type == "S_L"))
```

*Should we keep M \* D?*

```{r}
no_MD = lm(total_regional_bioarea ~
            metaecosystem_type +
            disturbance,
          data = ds_regional_biomass %>%
                            filter(time_point == chosen_time_point) %>%
                            filter(metaecosystem_type == "M_M" | metaecosystem_type == "S_L"))

AIC(full,no_MD)
```

No.

```{r}
best_model = no_MD

R2_full = glance(best_model)$r.squared

no_M = lm(total_regional_bioarea ~
            disturbance,
          data = ds_regional_biomass %>%
                            filter(time_point == chosen_time_point) %>%
                            filter(metaecosystem_type == "M_M" | metaecosystem_type == "S_L"))

R2_no_M = glance(no_M)$r.squared
R2_M = R2_full - R2_no_M

R2_full = round(R2_full, digits = 2)
R2_M = round(R2_M, digits = 2)
```

The adjusted R squared of the model is `r R2_full` and the adjusted R squared of patch type is `r R2_M`.
