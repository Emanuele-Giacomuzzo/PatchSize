---
title: "Untitled"
output: html_document
date: "2023-06-09"
editor_options: 
  chunk_output_type: console
---

```{r}
for(culture_ID_input in 1:n_cultures){
  for(protist_input in protist_species){
    
    protist_density_column = paste0(protist_input, "_indiv_per_ml")
    protist_last_saw_column = paste0(protist_input, "_last_saw_day")
    
    day_last_saw = ds_patches %>%
      filter(culture_ID == culture_ID_input) %>%
      select(day,
             all_of(protist_density_column)) %>%
      slice(which.max(.data[[protist_density_column]])) %>%
      pull(day)
    
    ds_patches[[protist_last_saw_column]][ds_patches$culture_ID == culture_ID_input] = day_last_saw
  }
}

patch_size_input = "Large"
for (protist_input in protist_species) {
  x_axis = paste0(protist_input, "_last_saw_day")
  
  p = ds_patches %>%
    filter(patch_size == patch_size_input,
           time_point == 0) %>%
    ggplot(aes(
      x = get(x_axis),
      y = patch_type,
      group = patch_type,
      colour = patch_type
    )) +
    geom_jitter(width = 0.2, height = 0.2) +
    scale_x_continuous(limits = c(0, 30)) +
    labs(title = ,
         x = paste("Last saw", protist_input),
         y = "") +
    theme(legend.position = "none")
  
  print(p)
}
```