---
title: "SL - size classes"
output: html_document
date: "2022-12-21"
editor_options: 
  chunk_output_type: console
---

#### Size Classes

##### Effect sizes

```{r}

for(size_class_input in 1:nr_of_size_classes) {

    filtered_data = ds_classes_effect_size %>%
    filter(
      disturbance == disturbance_input,
      eco_metaeco_type %in% c("L (S_L)", "S (S_L)"),
      time_point >= first_time_point_model,
      time_point <= last_time_point_model,
      size_class_n == size_class_input,
      day > 0
    ) %>%
    ungroup()
  
  p = filtered_data %>%
    ggplot(aes(x = day,
               y = abundance_hedges_d,
               color = eco_metaeco_type)) +
    geom_point(position = position_dodge(0.5)) +
    geom_line(position = position_dodge(0.5)) +
    geom_errorbar(
      aes(ymin = abundance_hedges_d_lower,
          ymax = abundance_hedges_d_upper),
      width = .2,
      position = position_dodge(0.5)
    ) +
    geom_hline(
      yintercept = 0,
      linetype = "dotted",
      color = "black",
      size = 0.7
    ) +
    labs(
      x = name_time_axis,
      y = paste0(
        "Class ",
        size_class_input,
       name_y_axis_size_class_effect_size
      ),
      color = ""
    ) +
    scale_color_manual(
      values = c(colour_L, colour_S),
      labels = c(name_L_connected_to_S,
                 name_S_connected_to_L)
    ) +
    theme_bw() +
    theme(
      panel.grid.major = element_blank(),
      panel.grid.minor = element_blank(),
      legend.position = "bottom"
    )
  
  print(p)
}
```