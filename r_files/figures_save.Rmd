---
title: "Save Nice Figures"
output: html_document
date: "2022-11-01"
editor_options: 
  chunk_output_type: console
---

```{r save-figures, echo  = FALSE}
small_patches_presentation = ds_patches_averaged %>%
      filter(!time_point == 0,
             disturbance == "low",
             eco_metaeco_type %in% c("S (S_S)", "S (S_L)")) %>%
      ggplot(aes(
        x = day,
        y = bioarea_per_volume_d,
        color = eco_metaeco_type
      )) +
      geom_point(position = position_dodge(0.5)) +
      geom_line(position = position_dodge(0.5)) +
      geom_errorbar(
        aes(ymin = bioarea_per_volume_d_lower,
            ymax = bioarea_per_volume_d_upper),
        width = .2,
        position = position_dodge(0.5)
      ) +
      labs(
        x = "Day",
        y = "Bioarea Density Effect Size (Hedge's d)",
        color = ""
      ) +
      scale_color_discrete(
        labels = c("Small connected to large",
                   "Small connnected to small")
      ) +
      scale_x_continuous(breaks = unique(ds_patches_averaged$day)) +
      theme_bw() +
      theme(
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        legend.position = "none"
      ) +
      geom_vline(
        xintercept = resource_flow_days[1] + 0.7,
        linetype = "dotdash",
        color = "grey",
        size = 0.7
      ) +
      geom_vline(
        xintercept = resource_flow_days[2] + 0.7,
        linetype = "dotdash",
        color = "grey",
        size = 0.7
      ) +
      geom_vline(
        xintercept = resource_flow_days[3] + 0.7,
        linetype = "dotdash",
        color = "grey",
        size = 0.7
      ) +
      geom_vline(
        xintercept = resource_flow_days[4] + 0.7,
        linetype = "dotdash",
        color = "grey",
        size = 0.7
      ) +
      geom_vline(
        xintercept = resource_flow_days[5] + 0.7,
        linetype = "dotdash",
        color = "grey",
        size = 0.7
      ) +
      geom_vline(
        xintercept = resource_flow_days[6] + 0.7,
        linetype = "dotdash",
        color = "grey",
        size = 0.7
      ) +
      geom_hline(
        yintercept = 0,
        linetype = "dotted",
        color = "black",
        size = 0.7
      )

small_patches_presentation

large_patches_presentation = ds_patches_averaged %>%
      filter(!time_point == 0,
             disturbance == "low",
             eco_metaeco_type %in% c("L (L_L)", "L (S_L)")) %>%
      ggplot(aes(
        x = day,
        y = bioarea_per_volume_d,
        color = eco_metaeco_type
      )) +
      geom_point(position = position_dodge(0.5)) +
      geom_line(position = position_dodge(0.5)) +
      geom_errorbar(
        aes(ymin = bioarea_per_volume_d_lower,
            ymax = bioarea_per_volume_d_upper),
        width = .2,
        position = position_dodge(0.5)
      ) +
      labs(
        x = "Day",
        y = "Bioarea Density Effect Size (Hedge's d)",
        color = ""
      ) +
      scale_color_discrete(
        labels = c("Large connected to large",
                   "Large connnected to small")
      ) +
      scale_x_continuous(breaks = unique(ds_patches_averaged$day)) +
      theme_bw() +
      theme(
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        legend.position = "none"
      ) +
      geom_vline(
        xintercept = resource_flow_days[1] + 0.7,
        linetype = "dotdash",
        color = "grey",
        size = 0.7
      ) +
      geom_vline(
        xintercept = resource_flow_days[2] + 0.7,
        linetype = "dotdash",
        color = "grey",
        size = 0.7
      ) +
      geom_vline(
        xintercept = resource_flow_days[3] + 0.7,
        linetype = "dotdash",
        color = "grey",
        size = 0.7
      ) +
      geom_vline(
        xintercept = resource_flow_days[4] + 0.7,
        linetype = "dotdash",
        color = "grey",
        size = 0.7
      ) +
      geom_vline(
        xintercept = resource_flow_days[5] + 0.7,
        linetype = "dotdash",
        color = "grey",
        size = 0.7
      ) +
      geom_vline(
        xintercept = resource_flow_days[6] + 0.7,
        linetype = "dotdash",
        color = "grey",
        size = 0.7
      ) +
      geom_hline(
        yintercept = 0,
        linetype = "dotted",
        color = "black",
        size = 0.7
      )

large_patches_presentation

ggsave(here("results", "presentation", "presentation_small_patches.jpg"), 
       small_patches_presentation + labs(title = ""), 
       units = publication_unit,
       width = 17, 
       height = publication_height)

metaecos_presentation = ds_regional_biomass %>%
      filter(disturbance == "low") %>%
      filter (metaecosystem_type == "S_L" |
                metaecosystem_type == "M_M") %>%
      ggplot (
        aes(
          x = day,
          y = total_regional_bioarea,
          group = interaction(day, metaecosystem_type),
          fill = metaecosystem_type
        )
      ) +
      geom_boxplot() +
      labs(
        x = "Day",
        y = "Meta-ecosystem Total Bioarea (µm²)",
        color = '',
        fill = ''
      ) +
      scale_fill_manual(
        values = c(colour_MM, colour_SL),
        labels = c("Medium-Medium",
                   "Small-Large")
      ) +
      theme_bw() +
      theme(
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        legend.position = "none"
      )  +
      scale_x_continuous(breaks = unique(ds_regional_biomass$day)) +
      geom_vline(
        xintercept = resource_flow_days[1] + 0.7,
        linetype = "dotdash",
        color = "grey",
        size = 0.7
      ) +
      geom_vline(
        xintercept = resource_flow_days[2] + 0.7,
        linetype = "dotdash",
        color = "grey",
        size = 0.7
      ) +
      geom_vline(
        xintercept = resource_flow_days[3] + 0.7,
        linetype = "dotdash",
        color = "grey",
        size = 0.7
      ) +
      geom_vline(
        xintercept = resource_flow_days[4] + 0.7,
        linetype = "dotdash",
        color = "grey",
        size = 0.7
      ) +
      geom_vline(
        xintercept = resource_flow_days[5] + 0.7,
        linetype = "dotdash",
        color = "grey",
        size = 0.7
      ) +
      geom_vline(
        xintercept = resource_flow_days[6] + 0.7,
        linetype = "dotdash",
        color = "grey",
        size = 0.7
      )

metaecos_presentation
  
ggsave(here("results", "presentation", "presentation_metaecos.jpg"), 
       metaecos_presentation + labs(title = ""), 
       units = publication_unit,
       width = 17, 
       height = publication_height)
```