---
title: "isolated_patches"
author: "Emanuele Giacomuzzo"
date: "2022-10-17"
output: html_document
editor_options: 
  chunk_output_type: console
---

### Isolated patches {.tabset .tabset-pills}

*Research question: *

#### Plots

```{r}
for (disturbance_input in c("low", "high")) {
  
  print(
    
    ds_biomass_abund %>%
          filter(disturbance == disturbance_input) %>%
          filter(metaecosystem == "no") %>%
          group_by(culture_ID, time_point) %>%
          mutate(species_richness_video_averaged = mean(species_richness)) %>%
          ungroup() %>%
          ggplot(aes(x = day,
                     y = species_richness_video_averaged,
                     group = interaction(day,eco_metaeco_type),
                     fill = eco_metaeco_type)) +
          geom_boxplot() +
          labs(title = paste("Disturbance =", disturbance_input),
               x = "Day",
               y = "Species richness",
               fill = "") +
          theme_bw() +
          theme(panel.grid.major = element_blank(),
                panel.grid.minor = element_blank(),
                legend.position = c(.99, .99),
                legend.justification = c("right", "top"),
        legend.box.just = "right",
        legend.margin = margin(6, 6, 6, 6)) +
          scale_fill_manual(values = c("#0071DC", "#6EA6DB", "#B1C8DE"),
                    labels = c("Large isolated",
                               "Medium isolated",
                               "Small isolated"))  +
      geom_vline(xintercept = first_perturbation_day + 0.7,
                     linetype = "dotdash",
                     color = "grey",
                     size = 0.7) +
          labs(caption = "Vertical grey line: first perturbation")
    )
  }
```