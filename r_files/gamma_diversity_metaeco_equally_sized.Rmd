---
title: "Gamma Diversity Equally Sized"
output: html_document
date: "2022-11-22"
editor_options: 
  chunk_output_type: console
---

#### Equally sized patches

```{r}
for (disturbance_input in c("low", "high")) {
  print(
    ds_metaecosystems %>%
      filter(disturbance == disturbance_input,
             !metaecosystem_type == "S_L",
             !metaecosystem_type == "S_L_from_isolated") %>%
      ggplot(
        aes(
          x = day,
          y = gamma_shannon,
          group = interaction(day, metaecosystem_type),
          fill = metaecosystem_type
        )
      ) +
      geom_boxplot() +
      labs(
        title = "Disturbance = low",
        x = "Day",
        y = "Gamma diversity (nr of species)",
        fill = ""
      ) +
      theme_bw() +
      theme(
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        legend.position = c(.3, .3),
        legend.justification = c("right", "top"),
        legend.box.just = "right",
        legend.margin = margin(6, 6, 6, 6)
      ) +
      scale_fill_manual(
        values = c(colour_large, colour_medium, colour_small),
        labels = c(
        "Large-Large",
        "Medium-Medium",
        "Small-Small"
      )) +
      geom_vline(
        xintercept = first_perturbation_day + 0.7,
        linetype = "dotdash",
        color = "grey",
        size = 0.7
      ) +
      labs(caption = "Vertical grey line: first perturbation")
  )
}
```