---
html_document:
  toc: yes
  toc_float: yes
  code_folding: hide
  number_sections: yes
  includes:
    after_body: "tabset-dropdown.html"
author: "Emanuele Giacomuzzo"
date: "`r format(Sys.time(), '%Y-%m-%d %H:%M')`"
output:
  html_document:
    code_folding: hide
    profiling: yes
bibliography: library.bib
title: "PhD Chapter 1 - PatchSize"
editor_options:
  chunk_output_type: console
---

Somewhere there's analysis small and large patches special

```{r echo=FALSE}
disturbance_global_input = "high"
print(paste("!!", disturbance_global_input, "!!", "(this document showcases only the analysis done for the", disturbance_global_input, "disturbance)"))
```

```{r child = here::here("r_files", "set_packages.Rmd"), echo = FALSE, message = FALSE, cache = FALSE, autodep = FALSE}
```

```{r child = here("r_files", "set_functions.Rmd"), echo=FALSE}
```

#  {.tabset}

## Design {.tabset .tabset-pills}

```{r child = here("r_files", "design.Rmd")}
```

## Parameters

```{r child = here("r_files", "set_parameters.Rmd"), class.source = 'fold-show'}
```

## Data {.tabset .tabset-dropdown}

```{r child = here("r_files", "ds_culture_info.Rmd")}
```

```{r child = here("r_files", "ds_individuals.Rmd")}
```

```{r child = here("r_files", "ds_patches.Rmd")}
```

```{r child = here("r_files", "ds_patches_effect_size.Rmd")}
```

```{r child = here("r_files", "ds_metaecos_1_patch_combinations.Rmd")}
```

```{r child = here("r_files", "ds_metaecos_2_patch_combination_sets.Rmd")}
```

```{r child = here("r_files", "ds_metaecos_3_finish.Rmd")}
```

```{r child = here("r_files", "ds_classes.Rmd"), eval = FALSE}
```

```{r child = here("r_files", "ds_classes_effect_size.Rmd"), eval = FALSE}
```

```{r child = here("r_files", "ds_all_filtered.Rmd")}
```

## Plots & Analysis {.tabset .tabset-dropdown}

### All Meta-ecosystems {.tabset .tabset-pills}

```{r}
metaecosystem_type_i = c("Small-Small meta-ecosystem",
                         "Medium-Medium meta-ecosystem",
                         "Medium-Medium unconnected",
                         "Large-Large meta-ecosystem",
                         "Small-Large meta-ecosystem",
                         "Small-Large unconnected")
```

#### Biomass {.tabset .tabset-pills}

```{r}
response_variable = "total_metaecosystem_bioarea_mm2"
```

```{r child = here("r_files", "analysis_metaecosystems_variable_all.Rmd")}
```

#### Alpha (mean Shannon) {.tabset .tabset-pills}

```{r}
response_variable = "mean_shannon"
```

```{r child = here("r_files", "analysis_metaecosystems_variable_all.Rmd")}
```

#### Beta (Bray-Curtis) {.tabset .tabset-pills}

```{r}
response_variable = "bray_curtis"
```

```{r child = here("r_files", "analysis_metaecosystems_variable_all.Rmd")}
```

#### Gamma (regional richness) {.tabset .tabset-pills}

```{r}
response_variable = "metaecosystem_richness"
```

```{r child = here("r_files", "analysis_metaecosystems_variable_all.Rmd")}
```

### MM vs SL {.tabset .tabset-pills}

#### Biomass {.tabset .tabset-pills}

```{r}
response_variable = "total_metaecosystem_bioarea_mm2"
```

```{r}
metaecosystem_type_i = c("Medium-Medium meta-ecosystem",
                         "Medium-Medium unconnected",
                         "Small-Large meta-ecosystem",
                         "Small-Large unconnected")
```

```{r child = here("r_files", "analysis_metaecosystems_variable_all.Rmd")}
```

##### MM vs SL meta-ecosystems {.tabset .tabset-pills}

```{r}
metaecosystem_type_i = c("Medium-Medium meta-ecosystem",
                         "Small-Large meta-ecosystem")
```

```{r child = here("r_files", "analysis_metaeco_symmetry.Rmd")}
```

##### SL (meta-ecosystems vs unconnected) {.tabset .tabset-pills}

```{r}
metaecosystem_type_i = c("Small-Large meta-ecosystem",
                         "Small-Large unconnected")
```

```{r echo=FALSE, message=FALSE}
save.image(file = here("environments", "before.RData"))
```

```{r child = here("r_files", "analysis_metaeco_connection.Rmd")}
```

##### MM (meta-ecosystems vs unconnected) {.tabset .tabset-pills}

```{r}
metaecosystem_type_i = c("Medium-Medium meta-ecosystem",
                         "Medium-Medium unconnected")
```

```{r child = here("r_files", "analysis_metaeco_connection.Rmd")}
```

#### Alpha (mean Shannon) {.tabset .tabset-pills}

```{r}
response_variable = "mean_shannon"
```

```{r}
metaecosystem_type_i = c("Medium-Medium meta-ecosystem",
                         "Medium-Medium unconnected",
                         "Small-Large meta-ecosystem",
                         "Small-Large unconnected")
```


```{r child = here("r_files", "analysis_metaecosystems_variable_all.Rmd")}
```

##### MM vs SL meta-ecosystems {.tabset .tabset-pills}

```{r}
metaecosystem_type_i = c("Medium-Medium meta-ecosystem",
                         "Small-Large meta-ecosystem")
```

```{r child = here("r_files", "analysis_metaeco_symmetry.Rmd")}
```

##### SL (meta-ecosystems vs unconnected) {.tabset .tabset-pills}

```{r}
metaecosystem_type_i = c("Small-Large meta-ecosystem",
                         "Small-Large unconnected")
```

```{r child = here("r_files", "analysis_metaeco_connection.Rmd")}
```

##### MM (meta-ecosystems vs unconnected) {.tabset .tabset-pills}

```{r}
metaecosystem_type_i = c("Medium-Medium meta-ecosystem",
                         "Medium-Medium unconnected")
```

```{r child = here("r_files", "analysis_metaeco_connection.Rmd")}
```

#### Beta (Bray-Curtis) {.tabset .tabset-pills}

```{r}
response_variable = "bray_curtis"
```

```{r}
metaecosystem_type_i = c("Medium-Medium meta-ecosystem",
                         "Medium-Medium unconnected",
                         "Small-Large meta-ecosystem",
                         "Small-Large unconnected")
```

```{r child = here("r_files", "analysis_metaecosystems_variable_all.Rmd")}
```

##### MM vs SL meta-ecosystems {.tabset .tabset-pills}

```{r}
metaecosystem_type_i = c("Medium-Medium meta-ecosystem",
                         "Small-Large meta-ecosystem")
```

```{r child = here("r_files", "analysis_metaeco_symmetry.Rmd")}
```

##### SL (meta-ecosystems vs unconnected) {.tabset .tabset-pills}

```{r}
metaecosystem_type_i = c("Small-Large meta-ecosystem",
                         "Small-Large unconnected")
```

```{r child = here("r_files", "analysis_metaeco_connection.Rmd")}
```

##### MM (meta-ecosystems vs unconnected) {.tabset .tabset-pills}

```{r}
metaecosystem_type_i = c("Medium-Medium meta-ecosystem",
                         "Medium-Medium unconnected")
```

```{r child = here("r_files", "analysis_metaeco_connection.Rmd")}
```

#### Gamma (regional richness) {.tabset .tabset-pills}

```{r}
response_variable = "metaecosystem_richness"
```

```{r}
metaecosystem_type_i = c("Medium-Medium meta-ecosystem",
                         "Medium-Medium unconnected",
                         "Small-Large meta-ecosystem",
                         "Small-Large unconnected")
```

```{r child = here("r_files", "analysis_metaecosystems_variable_all.Rmd")}
```

##### MM vs SL meta-ecosystems {.tabset .tabset-pills}

```{r}
metaecosystem_type_i = c("Medium-Medium meta-ecosystem",
                         "Small-Large meta-ecosystem")
```

```{r child = here("r_files", "analysis_metaeco_symmetry.Rmd")}
```

##### SL (meta-ecosystems vs unconnected) {.tabset .tabset-pills}

```{r}
metaecosystem_type_i = c("Small-Large meta-ecosystem",
                         "Small-Large unconnected")
```

```{r child = here("r_files", "analysis_metaeco_connection.Rmd")}
```

##### MM (meta-ecosystems vs unconnected) {.tabset .tabset-pills}

```{r}
metaecosystem_type_i = c("Medium-Medium meta-ecosystem",
                         "Medium-Medium unconnected")
```

```{r child = here("r_files", "analysis_metaeco_connection.Rmd")}
```

### All patches {.tabset .tabset-pills}

```{r}
patch_type_i = c("Small unconnected",
                     "Medium unconnected",
                     "Large unconnected",
                     "Small connected to small",
                     "Small connected to large",
                     "Medium connected to medium",
                     "Large connected to small",
                     "Large connected to large")
```

#### BEF {.tabset .tabset-pills}

```{r child = here("r_files", "analysis_patches_BEF.Rmd")}
```

```{r echo = FALSE, eval = FALSE}

#Try to use a comprehensive model for all patches
full_model = lmer(
  bioarea_mm2_per_ml ~
    patch_size * connection +
    (1 | day) +
    (1 | culture_ID),
  data = ds_patches,
  REML = FALSE,
  control = lmerControl(optimizer = "Nelder_Mead"))

summary(full_model)

anova(full_model)

emmeans::emmeans(full_model,
                 specs = pairwise ~ patch_size:connection,
                 type = "response",
                 adjust = "tukey")
```


### Isolated patches {.tabset .tabset-pills}

```{r}
patch_type_i = c("Small unconnected",
                 "Medium unconnected",
                 "Large unconnected")
```

#### Biomass {.tabset .tabset-pills}

```{r}
response_variable = "bioarea_mm2_per_ml"
```

```{r child = here("r_files", "analysis_unconnected_patches_variable.Rmd")}
```

#### Shannon {.tabset .tabset-pills}

```{r}
response_variable = "shannon"
```

```{r child = here("r_files", "analysis_unconnected_patches_variable.Rmd")}
```

#### Richness {.tabset .tabset-pills}

```{r}
response_variable = "species_richness"
```

```{r child = here("r_files", "analysis_unconnected_patches_variable.Rmd")}
```

#### Evenness {.tabset .tabset-pills}

```{r}
response_variable = "evenness_pielou"
```

```{r child = here("r_files", "analysis_unconnected_patches_variable.Rmd")}
```

#### Median Size {.tabset .tabset-pills}

```{r}
response_variable = "median_body_area_µm2"
```

```{r child = here("r_files", "analysis_unconnected_patches_variable.Rmd")}
```

#### Auto/Hetero {.tabset .tabset-pills}

```{r}
response_variable = "auto_hetero_ratio"
```

```{r child = here("r_files", "analysis_unconnected_patches_variable.Rmd")}
```

#### Populations

```{r child = here("r_files", "analysis_patches_populations.Rmd")}
```

### S_L vs S {.tabset .tabset-pills}

```{r}
patch_type_i = c("Small connected to large",
                 "Small unconnected")
```

#### Biomass {.tabset .tabset-pills}

```{r}
response_variable = "bioarea_mm2_per_ml"
```

```{r child = here("r_files", "analysis_small_n_large_patches.Rmd")}
```

#### Shannon {.tabset .tabset-pills}

```{r}
response_variable = "shannon"
```

```{r child = here("r_files", "analysis_small_n_large_patches.Rmd")}
```

#### Richness {.tabset .tabset-pills}

```{r}
response_variable = "species_richness"
```

```{r child = here("r_files", "analysis_small_n_large_patches.Rmd")}
```

#### Evenness {.tabset .tabset-pills}

```{r}
response_variable = "evenness_pielou"
```

```{r child = here("r_files", "analysis_small_n_large_patches.Rmd")}
```

#### Median Size {.tabset .tabset-pills}

```{r}
response_variable = "median_body_area_µm2"
```

```{r child = here("r_files", "analysis_small_n_large_patches.Rmd")}
```

#### Populations

```{r child = here("r_files", "analysis_patches_populations.Rmd")}
```

### S_L vs S_S {.tabset .tabset-pills}

```{r}
patch_type_i = c("Small connected to large",
                 "Small connected to small")
```

#### Biomass {.tabset .tabset-pills}

```{r}
response_variable = "bioarea_mm2_per_ml"
```

```{r child = here("r_files", "analysis_small_n_large_patches.Rmd")}
```

#### Shannon {.tabset .tabset-pills}

```{r}
response_variable = "shannon"
```

```{r child = here("r_files", "analysis_small_n_large_patches.Rmd")}
```

#### Richness {.tabset .tabset-pills}

```{r}
response_variable = "species_richness"
```

```{r child = here("r_files", "analysis_small_n_large_patches.Rmd")}
```

#### Evenness {.tabset .tabset-pills}

```{r}
response_variable = "evenness_pielou"
```

```{r child = here("r_files", "analysis_small_n_large_patches.Rmd")}
```

#### Median Size {.tabset .tabset-pills}

```{r}
response_variable = "median_body_area_µm2"
```

```{r child = here("r_files", "analysis_small_n_large_patches.Rmd")}
```

#### Populations

```{r child = here("r_files", "analysis_patches_populations.Rmd")}
```

### S_S vs S {.tabset .tabset-pills}

```{r}
patch_type_i = c("Small connected to small",
                 "Small unconnected")
```

#### Biomass {.tabset .tabset-pills}

```{r}
response_variable = "bioarea_mm2_per_ml"
```

```{r child = here("r_files", "analysis_small_n_large_patches.Rmd")}
```

#### Shannon {.tabset .tabset-pills}

```{r}
response_variable = "shannon"
```

```{r child = here("r_files", "analysis_small_n_large_patches.Rmd")}
```

#### Richness {.tabset .tabset-pills}

```{r}
response_variable = "species_richness"
```

```{r child = here("r_files", "analysis_small_n_large_patches.Rmd")}
```

#### Evenness {.tabset .tabset-pills}

```{r}
response_variable = "evenness_pielou"
```

```{r child = here("r_files", "analysis_small_n_large_patches.Rmd")}
```

#### Median Size {.tabset .tabset-pills}

```{r}
response_variable = "median_body_area_µm2"
```

```{r child = here("r_files", "analysis_small_n_large_patches.Rmd")}
```

#### Populations

```{r child = here("r_files", "analysis_patches_populations.Rmd")}
```

### Medium patches {.tabset .tabset-pills}

```{r}
patch_type_i = c("Medium unconnected",
                     "Medium connected to medium")
```

#### Biomass {.tabset .tabset-pills}

```{r}
response_variable = "bioarea_mm2_per_ml"
```

```{r child = here("r_files", "analysis_small_n_large_patches.Rmd")}
```

#### Shannon {.tabset .tabset-pills}

```{r}
response_variable = "shannon"
```

```{r child = here("r_files", "analysis_small_n_large_patches.Rmd")}
```

#### Richness {.tabset .tabset-pills}

```{r}
response_variable = "species_richness"
```

```{r child = here("r_files", "analysis_small_n_large_patches.Rmd")}
```

#### Evenness {.tabset .tabset-pills}

```{r}
response_variable = "evenness_pielou"
```

```{r child = here("r_files", "analysis_small_n_large_patches.Rmd")}
```

#### Median Size {.tabset .tabset-pills}

```{r}
response_variable = "median_body_area_µm2"
```

```{r child = here("r_files", "analysis_small_n_large_patches.Rmd")}
```

#### Populations

```{r child = here("r_files", "analysis_patches_populations.Rmd")}
```

### L_S vs L {.tabset .tabset-pills}

```{r}
patch_type_i = c("Large connected to small",
                 "Large unconnected")
```

#### Biomass {.tabset .tabset-pills}

```{r}
response_variable = "bioarea_mm2_per_ml"
```

```{r child = here("r_files", "analysis_small_n_large_patches_special_control.Rmd")}
```

#### Shannon {.tabset .tabset-pills}

```{r}
response_variable = "shannon"
```

```{r child = here("r_files", "analysis_small_n_large_patches.Rmd")}
```

#### Richness {.tabset .tabset-pills}

```{r}
response_variable = "species_richness"
```

```{r child = here("r_files", "analysis_small_n_large_patches.Rmd")}
```

#### Evenness {.tabset .tabset-pills}

```{r}
response_variable = "evenness_pielou"
```

```{r child = here("r_files", "analysis_small_n_large_patches.Rmd")}
```

#### Median Size {.tabset .tabset-pills}

```{r}
response_variable = "median_body_area_µm2"
```

```{r child = here("r_files", "analysis_small_n_large_patches.Rmd")}
```

#### Populations

```{r child = here("r_files", "analysis_patches_populations.Rmd")}
```

### L_S vs L_L {.tabset .tabset-pills}

```{r}
patch_type_i = c("Large connected to small",
                 "Large connected to large")
```

#### Biomass {.tabset .tabset-pills}

```{r}
response_variable = "bioarea_mm2_per_ml"
```

```{r child = here("r_files", "analysis_small_n_large_patches_special_control.Rmd")}
```

#### Shannon {.tabset .tabset-pills}

```{r}
response_variable = "shannon"
```

```{r child = here("r_files", "analysis_small_n_large_patches.Rmd")}
```

#### Richness {.tabset .tabset-pills}

```{r}
response_variable = "species_richness"
```

```{r child = here("r_files", "analysis_small_n_large_patches.Rmd")}
```

#### Evenness {.tabset .tabset-pills}

```{r}
response_variable = "evenness_pielou"
```

```{r child = here("r_files", "analysis_small_n_large_patches.Rmd")}
```

#### Median Size {.tabset .tabset-pills}

```{r}
response_variable = "median_body_area_µm2"
```

```{r child = here("r_files", "analysis_small_n_large_patches.Rmd")}
```

#### Populations

```{r child = here("r_files", "analysis_patches_populations.Rmd")}
```

### L_L vs L {.tabset .tabset-pills}

```{r}
patch_type_i = c("Large connected to large",
                 "Large unconnected")
```

#### Biomass {.tabset .tabset-pills}

```{r}
response_variable = "bioarea_mm2_per_ml"
```

```{r child = here("r_files", "analysis_small_n_large_patches.Rmd")}
```

#### Shannon {.tabset .tabset-pills}

```{r}
response_variable = "shannon"
```

```{r child = here("r_files", "analysis_small_n_large_patches.Rmd")}
```

#### Richness {.tabset .tabset-pills}

```{r}
response_variable = "species_richness"
```

```{r child = here("r_files", "analysis_small_n_large_patches.Rmd")}
```

#### Evenness {.tabset .tabset-pills}

```{r}
response_variable = "evenness_pielou"
```

```{r child = here("r_files", "analysis_small_n_large_patches.Rmd")}
```

#### Median Size {.tabset .tabset-pills}

```{r}
response_variable = "median_body_area_µm2"
```

```{r child = here("r_files", "analysis_small_n_large_patches.Rmd")}
```

#### Populations

```{r child = here("r_files", "analysis_patches_populations.Rmd")}
```

## Results {.tabset .tabset-pills}

### Meta-ecosystems

```{r child = here("r_files", "paper_metaecos.Rmd")}
```

```{r child = here("r_files", "present_metaecos.Rmd")}
```

### Connected patches

```{r child = here("r_files", "paper_connected_ecosystems.Rmd")}
```

### Isolated patches

```{r child = here("r_files", "paper_unconnected_ecosystems.Rmd")}
```

### Autotrophic species

```{r child = here("r_files", "paper_auto_hetero_ratio.Rmd")}
```

## Evaporation

```{r child = here("r_files", "evaporation_model.Rmd"), eval=FALSE}
```

```{r child = here("r_files", "evaporation_test.Rmd")}
```

## Analysis scripts {.tabset .tabset-pills}

### Video analysis

```{r child = here("r_files", "BEMOVI_script_video_analysis.Rmd"), class.source = "fold-show"}
```

### Species identification

```{r child = here("r_files", "BEMOVI_script_species_id.Rmd"), class.source = "fold-show"}
```

## Other

```{r child = here("r_files", "other.Rmd")}
```