---
title: "PatchSizePilot"
author: "Emanuele Giacomuzzo"
date: "2022-08-03"
output: 
  html_document:
    code_folding: hide
bibliography: library.bib
html_document:
    toc: true
    toc_float: true
    code_folding: hide
    number_sections: true
    includes:
      after_body: tabset-dropdown.html
editor_options: 
  chunk_output_type: console
---

```{r renv-seetings, eval = FALSE, echo = FALSE}
#renv::repair()
#renv::restore()
#renv::snapshot()
```

```{r set-up-environment, echo = FALSE}
knitr::opts_chunk$set(message = FALSE, cache=TRUE)
rm( list = ls(  ) )
cat( "\014" )
start_time = Sys.time()
recompute_analyses = FALSE #Lengthy analyses have been suppressed. However, if you set recompute_analyses = TRUE it redoes them. 
```

```{r packages, echo = FALSE, results = FALSE, message = FALSE, cache = FALSE}
library("conflicted")
library("tidyverse")
library("grid")
library("gridExtra") 
library("lme4")
library("here")
library("MuMIn")
library("equatiomatic")
library("knitr")
library("optimx")
library("GenSA")
library("purrr")
library("kableExtra")
library("DT")
library("renv")
library("broom")
library("patchwork")
library("gganimate") 
library("gapminder")
library("gifski")
library("av")
library("transformr")
library("gifski")
library("GGally")
#library("strengejacke")
library("sjPlot")
library("sjstats")
library("partR2")
library("SciViews")
library("effsize")
library("boot")
library("vegan")
library("betapart")

conflict_prefer("load", "base")
conflict_prefer("filter", "dplyr")
```

```{r functions, echo = FALSE}
source(here("r_files", "functions", "calculate.hedges_d.R"))
```

```{r various-parameters, echo = FALSE}
culture_info = read.csv(here("data", "PatchSizePilot_culture_info.csv"), header = TRUE)

gif_figures = TRUE

publication_width = 12
publication_height = 12
publication_unit = "cm"

nr_videos = c(12,1,1,1,1,1,2,2)
last_time_point = 7
n_time_points = 8
first_perturbation_day = 5
ecosystems_to_take_off = 60 #Culture ID = 60 because it was spilled (isolated small patch, high disturbance, system nr = 40)
metaecosystems_to_take_off = 40 #System 40 was the system of culture 60 that I spilled
protist_species = c("Ble", "Cep", "Col", "Eug", "Eup", "Lox", "Pau", "Pca", "Spi", "Spi_te", "Tet")
n_protist_species = length(protist_species)
n_metaecosystems = 55
n_cultures = 110
eco_metaeco_types = unique(culture_info$eco_metaeco_type)

colour_isolated = "#d9cbbe"
colour_different_size = "#4992c6"
colour_same_size = "#bc9960"
colour_small = "#ffff00"
colour_medium = "#ff9933"
colour_large = "#ff0000"
colour_MM = "#dd7f42" #Colour of the Medium-Medium meta-ecosystem
colour_SL = "#438cbe" #Colour of the Small-Large meta-ecosystem 
```

# PatchSizePilot {.tabset}

```{r overview-experiment, child = here("r_files", "overview.Rmd")}
```

## Data {.tabset .tabset-pills}

```{r child = here("r_files", "data_experimental_treatments.Rmd")}
```

```{r child = here("r_files", "data_biomass_abundance_data.Rmd")}
```

```{r child = here("r_files", "data_body_size_data.Rmd")}
```

## Meta-Ecosystem Biomass {.tabset .tabset-dropdown}

```{r child = here("r_files", "biomass_metaeco_all.Rmd")}
```

```{r child = here("r_files", "biomass_MM_SL_plots.Rmd")}
```

```{r child = here("r_files", "biomass_MM_SL_time_series.Rmd")}
```

```{r child = here("r_files", "biomass_MM_SL_single_points.Rmd")}
```

```{r child = here("r_files", "biomass_SL_SL_from_isolated.Rmd"), eval = FALSE}
```

```{r child = here("r_files", "biomass_metaeco_equally_sized_patches.Rmd")}
```
## Patches: Biomass {.tabset .tabset-dropdown}

```{r child = here("r_files", "biomass_all_patches.Rmd")}
```

```{r child = here("r_files", "biomass_small_patches.Rmd")}
```

```{r child = here("r_files", "biomass_large_patches.Rmd")}
```

```{r child = here("r_files", "biomass_isolated_patches.Rmd")}
```

## Patches: Community Abundance {.tabset .tabset-dropdown}

```{r child = here("r_files", "comm_abundance_small_patches.Rmd")}
```

```{r child = here("r_files", "comm_abundance_large_patches.Rmd")}
```

```{r child = here("r_files", "comm_abundance_isolated_patches.Rmd")}
```

## Patches: Population Abundances {.tabset .tabset-dropdown}

```{r child = here("r_files", "population_abundances_small_patches.Rmd")}
```

```{r child = here("r_files", "population_abundances_large_patches.Rmd")}
```

```{r child = here("r_files", "population_abundances_isolated_patches.Rmd")}
```

## Biodiversity {.tabset .tabset-pills}

### Alpha Diversity {.tabset .tabset-dropdown}

```{r child = here("r_files", "alpha_diversity_small_patches.Rmd")}
```

```{r child = here("r_files", "alpha_diversity_large_patches.Rmd")}
```

```{r child = here("r_files", "alpha_diversity_isolated_patches.Rmd")}
```

### Beta Diversity {.tabset .tabset-dropdown}

```{r child = here("r_files", "beta_diversity.Rmd")}
```

### Gamma Diversity {.tabset .tabset-dropdown}

```{r child = here("r_files", "gamma_diversity.Rmd")}
```

## Body size distribution {.tabset .tabset-dropdown}

```{r child = here("r_files", "body_size_distribution_gifs.Rmd"), eval = FALSE}
```

```{r child = here("r_files", "body_size_distribution_small_patches.Rmd")}
```

```{r child = here("r_files", "body_size_distribution_large_patches.Rmd")}
```

```{r child = here("r_files", "body_size_distribution_isolated_patches.Rmd")}
```

## Median body size {.tabset .tabset-dropdown}

```{r child = here("r_files", "body_size_median_all_patches.Rmd")}
```

```{r child = here("r_files", "body_size_median_small_patches.Rmd")}
```

```{r child = here("r_files", "body_size_median_large_patches.Rmd")}
```

```{r child = here("r_files", "body_size_median_isolated_patches.Rmd")}
```

## Evaporation {.tabset .tabset-pills}

```{r child = here("r_files", "evaporation.Rmd")}
```

```{r child = here("r_files", "evaporation_tests.Rmd")}
```

## Running time

```{r running-time, echo = FALSE, eval = TRUE}
end_time = Sys.time()
end_time - start_time
```

## Bibliography