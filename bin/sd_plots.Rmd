---
title: "sd_plots"
author: "Emanuele Giacomuzzo"
date: "2022-08-02"
output: html_document
---

And their mean and standard deviation.

```{r echo = FALSE}

ds_regional %>%
  group_by(metaecosystem_type, disturbance, day) %>%
  summarise(mean_bioarea = mean(regional_mean_bioarea), 
            sd_bioarea = sd(regional_mean_bioarea)) %>%
  filter(disturbance == "low") %>%
  filter (metaecosystem_type == "S_L" | metaecosystem_type == "M_M") %>%
  ggplot (aes(x = day,
                y = mean_bioarea,
                fill = metaecosystem_type,
                color = metaecosystem_type)) +
  geom_line (stat = "summary", 
             fun = "mean", 
             position=position_dodge(width=0.5)) +
  geom_pointrange(aes(ymin = mean_bioarea - sd_bioarea, 
                      ymax = mean_bioarea + sd_bioarea),
                  position=position_dodge(width=0.5)) +
  labs(x = "Day", 
       y = "Mean bioarea between two patches (something/µl)",
       title = "Disturbance = low",
       color='', 
       fill='') +
  scale_fill_discrete(labels = c("Same size", 
                                 "Different size")) +
  scale_color_discrete(labels = c("Same size", 
                                  "Different size")) +
  theme_bw() +
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        legend.position = c(.95, .95),
        legend.justification = c("right", "top"),
        legend.box.just = "right",
        legend.margin = margin(6, 6, 6, 6))

ds_regional %>%
  group_by(metaecosystem_type, disturbance, day) %>%
  summarise(mean_bioarea = mean(regional_mean_bioarea), 
            sd_bioarea = sd(regional_mean_bioarea)) %>%
  filter(disturbance == "high") %>%
  filter (metaecosystem_type == "S_L" | metaecosystem_type == "M_M") %>%
  ggplot (aes(x = day,
                y = mean_bioarea,
                fill = metaecosystem_type,
                color = metaecosystem_type)) +
  #geom_point(stat = "summary", fun = "mean") +
  geom_line (stat = "summary", 
             fun = "mean", 
             position=position_dodge(width=0.5)) +
  geom_pointrange(
    aes(ymin = mean_bioarea - sd_bioarea, 
        ymax = mean_bioarea + sd_bioarea),
    position=position_dodge(width=0.5)) +
  labs(x = "Day", 
       y = "Mean bioarea between two patches (something/µl)",
       title = "Disturbance = high",
       color='', 
       fill='') +
  scale_fill_discrete(labels = c("Same size", 
                                 "Different size")) +
  scale_color_discrete(labels = c("Same size", 
                                  "Different size")) +
  theme_bw() +
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        legend.position = c(.95, .95),
        legend.justification = c("right", "top"),
        legend.box.just = "right",
        legend.margin = margin(6, 6, 6, 6))
```